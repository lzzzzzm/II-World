<div align="center">

# 🌍 $I^2$-World: Intra-Inter Tokenization for Efficient Dynamic 4D Scene Forecasting 

</div>

## 🚀 News

* **[2025-06]** **$I^2$-World** is accepted to ICCV 2025.


## 🛠️Environment

Install Pytorch 1.13 + CUDA 11.6

```setup
conda create --name stcocc python=3.8
pip install torch==1.13.0+cu116 torchvision==0.14.0+cu116 torchaudio==0.13.0 --extra-index-url https://download.pytorch.org/whl/cu116
```

Install mmdet3d (v1.0.0rc4) related packages and build this project
```setup
pip install mmcv-full==1.7.0 -f https://download.openmmlab.com/mmcv/dist/cu117/torch1.13/index.html
pip install mmdet==2.28.2
pip install mmsegmentation==0.30.0
pip install mmengine
pip install -v -e .
```

Install other dependencies
```setup
pip install -r requirements.txt
```

## 🤗 Model Zoo

<div class="note" style="background: #f0f7ff; padding: 10px; border-left: 3px solid #4285f4;">
    <strong>Note:</strong> We utilize 8 RTX4090 GPUs to train our model.
</div>

<div align="center">

|   Setting    |   Dataset   | Rec.mIoU (%) | Rec.IoU (%) |                                                Weights                                                | 
|:------------:|:-----------:|:------------:|:-----------:|:-----------------------------------------------------------------------------------------------------:|
| II-Tokenizer |  Occ3D-nus  |     81.1     |    68.1     | [Google-drive](https://drive.google.com/file/d/1JqFEtU4xbhfiOLWktS6n3PM1Q_CZXLO9/view?usp=drive_link) |
|  zero-shot   | Occ3D-Waymo |     76.3     |    74.6     |                                                   -                                                   |

|   Setting    | Dataset   | Fore.mIoU | Fore.IoU (%) |                                                Weights                                                | 
|:------------:|-----------|:---------:|:------------:|-------------------------------------------------------------------------------------------------------|
|   II-World   | Occ3D-nus |   38.4    |     49.2     | [Google-drive](https://drive.google.com/file/d/11qFkO-lpdFdfd443eospIRPii9QGSzFD/view?usp=sharing)                                            |

</div>

## 📦 Prepare Dataset

1. Download nuScenes from [nuScenes](https://www.nuscenes.org/nuscenes) 

2. Download Occ3D-nus from [Occ3D-nus](https://drive.google.com/file/d/1kiXVNSEi3UrNERPMz_CfiJXKkgts_5dY/view?usp=drive_link) and (optional) download the Occ3D-Waymo from [Occ3D-Waymo](https://drive.google.com/drive/folders/13WxRl9Zb_AshEwvD96Uwz8cHjRNrtfQk), we only use the validation of Occ3D-Waymo in our experiments.

3. Download the generated info file from [Google Drive](https://drive.google.com/drive/folders/1nXMyP9FueCuJ-1kFLvFbzvdnaUkwL1L6?usp=drive_link)
and unzip it to the `data/nuscenes` folder. These `*pkl` files can be generated by running the `tools/create_data.py`

4. Organize your folder structure as below:

```
├── project
├── data/
│   ├── nuscenes/
│   │   ├── samples/ 
│   │   ├── v1.0-trainval/
│   │   ├── gts/ (Occ3D-nus)
│   │   ├── world-nuscenes_infos_train.pkl
│   │   ├── world-nuscenes_infos_val.pkl
│   ├── waymo(optional)/
│   │   ├── validation/ 
│   │   ├── cam_infos_vali.pkl/ 
│   │   ├── waymo_infos_val.pkl/ 
```
